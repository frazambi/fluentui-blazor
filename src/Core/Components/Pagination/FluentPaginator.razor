@namespace Microsoft.FluentUI.AspNetCore.Components
@inherits FluentComponentBase
<div class="paginator" style="@Style">
    @if (State.TotalItemCount.HasValue)
    {
        <div class="summary">
            @if (SummaryTemplate is not null)
            {
                @SummaryTemplate
            }
            else
            {
                <text><strong>@State.TotalItemCount</strong> items</text>
            }
        </div>
        <nav role="navigation" class="paginator-nav">
            <FluentButton @onclick="GoFirstAsync" Disabled="@(!CanGoBack || Disabled)" title="Go to first page" aria-label="Go to first page">
                <FluentIcon Value="@(new CoreIcons.Regular.Size20.ChevronDoubleLeft())" Width="20px" />
            </FluentButton>
            <FluentButton @onclick="GoPreviousAsync" Disabled="@(!CanGoBack || Disabled)" title="Go to previous page" aria-label="Go to previous page">
                <FluentIcon Value="@(new CoreIcons.Regular.Size24.ChevronLeft())" Width="20px" />
            </FluentButton>
            <div class="pagination-text">
                @if (PaginationTextTemplate is not null)
                {
                    @PaginationTextTemplate
                }
                else
                {
                    if (VisiblePageNumbers)
                    {
                        int startIndex = Math.Max(State.CurrentPageIndex - (PageButtonsShown / 2), 0);
                        int endIndex = startIndex + PageButtonsShown - 1;
                        if (endIndex > State.LastPageIndex)
                            startIndex = Math.Max(startIndex - (endIndex - State.LastPageIndex ?? 0), 0);
                        endIndex = Math.Min(endIndex, State.LastPageIndex ?? startIndex);

                        for (int i = startIndex; i <= endIndex; i++)
                        {
                            // ho bisogno di copiarmi il valore di i in un'altra variabile altrimenti onclick e ChildContent non funzionano
                            int j = i;
                            <FluentButton @onclick="() => GoToPageAsync(j)" Disabled="@(State.CurrentPageIndex == j)" title="@($"Pagina {(j + 1)}")" aria-label="@($"Vai alla pagina {(j + 1)}")">@(j + 1)</FluentButton>
                        }
                    }
                }

            </div>
            <FluentButton @onclick="GoNextAsync" Disabled="@(!CanGoForwards || Disabled)" title="Go to next page" aria-label="Go to next page">
                <FluentIcon Value="@(new CoreIcons.Regular.Size24.ChevronRight())" Width="20px" />
            </FluentButton>
            <FluentButton @onclick="GoLastAsync" Disabled="@(!CanGoForwards || Disabled)" title="Go to last page" aria-label="Go to last page">
                <FluentIcon Value="@(new CoreIcons.Regular.Size20.ChevronDoubleRight())" Width="20px" />
            </FluentButton>
        </nav>
    }
</div>
